<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAIRO'S PHONE</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap');
        
        * { box-sizing: border-box; user-select: none; }
        body { 
            margin: 0; padding: 0; 
            background: #111; 
            display: flex; justify-content: center; align-items: center; 
            min-height: 100vh; font-family: 'Inter', sans-serif; 
        }

        /* í° í”„ë ˆì„ */
        .phone-frame {
            width: 360px; height: 740px;
            background: #000;
            border-radius: 45px;
            border: 10px solid #222;
            box-shadow: 0 0 60px rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
        }

        /* ë…¸ì¹˜ & ìƒë‹¨ë°” */
        .notch {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 120px; height: 25px; background: #000;
            border-bottom-left-radius: 18px; border-bottom-right-radius: 18px;
            z-index: 100;
        }
        .status-bar {
            padding: 12px 25px; display: flex; justify-content: space-between;
            font-size: 13px; color: #fff; font-weight: 600; position: relative; z-index: 90;
            text-shadow: 0 1px 3px rgba(0,0,0,0.8);
        }

        /* --- 2. í™ˆ í™”ë©´ --- */
        .home-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover !important;
            background-position: center !important;
            display: flex; flex-direction: column; padding-top: 55px; 
            z-index: 10;
        }

        /* --- 1. ì ê¸ˆ í™”ë©´ --- */
        .lock-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.2); 
            backdrop-filter: blur(15px); 
            -webkit-backdrop-filter: blur(15px);
            display: flex; flex-direction: column; align-items: center; padding-top: 80px;
            color: #fff;
            transition: transform 0.4s ease-in-out;
            z-index: 50;
        }
        .lock-time { font-size: 72px; font-weight: 200; letter-spacing: -2px; text-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        .lock-date { font-size: 18px; margin-top: -10px; font-weight: 400; margin-bottom: 40px; text-shadow: 0 1px 5px rgba(0,0,0,0.5); }

        .passcode-dots { display: flex; gap: 15px; margin-bottom: 40px; }
        .dot { width: 12px; height: 12px; border: 1px solid #fff; border-radius: 50%; transition: 0.2s; box-shadow: 0 0 5px rgba(0,0,0,0.3); }
        .dot.filled { background: #fff; }

        .keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px 30px; width: 80%; }
        .key { width: 70px; height: 70px; border-radius: 50%; background: rgba(255,255,255,0.15); display: flex; justify-content: center; align-items: center; font-size: 24px; font-weight: 400; cursor: pointer; transition: 0.2s; text-shadow: 0 1px 3px rgba(0,0,0,0.5); }
        .key:active { background: rgba(255,255,255,0.4); }

        .shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } }

        /* ìœ„ì ¯ ì˜ì—­ */
        .widget-area { padding: 10px 20px; }
        .d-day-widget {
            background: linear-gradient(135deg, rgba(255,154,158,0.85), rgba(254,207,239,0.85));
            backdrop-filter: blur(5px);
            border-radius: 16px; 
            padding: 12px 20px; 
            color: #fff;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            display: flex; justify-content: space-between; align-items: center;
        }
        .dd-text-group { text-align: left; }
        .dd-title { font-size: 12px; font-weight: 600; opacity: 0.95; margin-bottom: 2px; text-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .dd-sub { font-size: 10px; opacity: 0.85; font-weight: 500;}
        .dd-count { font-size: 26px; font-weight: 800; margin: 0; text-shadow: 0 2px 4px rgba(0,0,0,0.15); }

        /* í•˜ë‹¨ ì•± ì•„ì´ì½˜ */
        .app-grid {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px 10px;
            padding: 20px; margin-top: auto; margin-bottom: 30px;
        }
        .app-icon { display: flex; flex-direction: column; align-items: center; gap: 8px; cursor: pointer; transition: 0.2s; }
        .app-icon:active { transform: scale(0.9); }
        .icon-img {
            width: 60px; height: 60px; border-radius: 14px;
            display: flex; justify-content: center; align-items: center;
            font-size: 26px; color: #fff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .app-name { font-size: 11px; color: #fff; font-weight: 500; text-shadow: 0 2px 4px rgba(0,0,0,0.9); }

        .ic-gal { background: #4facfe; } 
        .ic-memo { background: #ffd166; } 
        .ic-search { background: #06d6a0; } 
        .ic-cal { background: #9b5de5; } 

        /* --- 3. ì•± ì‹¤í–‰ í™”ë©´ ê³µí†µ --- */
        .app-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; z-index: 20;
            transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex; flex-direction: column;
        }
        .app-screen.open { transform: translateY(0); }
        
        .app-header {
            padding: 50px 20px 15px; font-size: 18px; font-weight: 700;
            border-bottom: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center;
            background: rgba(255,255,255,0.98); color: #333;
        }
        .close-btn { font-size: 14px; color: #007aff; cursor: pointer; font-weight: 600; }
        .app-content { flex: 1; overflow-y: auto; padding: 20px; background: #fafafa; }

        .add-btn { font-size: 24px; color: #007aff; cursor: pointer; margin-right: 15px; }
        
        .delete-btn { font-size: 14px; cursor: pointer; opacity: 0.5; transition: 0.2s; }
        .delete-btn:active { opacity: 1; transform: scale(0.9); }

        /* ìº˜ë¦°ë” ìŠ¤íƒ€ì¼ */
        .cal-list { display: flex; flex-direction: column; gap: 10px; padding-bottom: 30px; }
        .cal-item { background: #fff; padding: 15px 20px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.03); border: 1px solid #eee; position: relative; overflow: hidden; }
        .cal-item.custom-event { border-left: 4px solid #007aff; }
        .cal-item.milestone { border: 1px solid #FF9A9E; background: #fff5f5; }
        .cal-item.ripley-bd { border: 1px solid #9b5de5; background: #f3e5f5; }
        .cal-item.ripley-bd::before { content: 'â™¥'; position: absolute; top: -5px; left: -5px; font-size: 40px; color: rgba(155, 93, 229, 0.1); }
        .cal-item.kairo-bd { background: #f9f9f9; opacity: 0.7; }
        .cal-item.love-day { background: #fff0f6; border-color: #ffadd2; }
        .cal-title { font-size: 15px; font-weight: 700; color: #333; display: flex; align-items: center; gap: 5px; }
        .cal-date { font-size: 13px; color: #666; margin-top: 2px; }
        .cal-dday { font-size: 12px; font-weight: bold; color: #9b5de5; background: #fff; padding: 4px 8px; border-radius: 6px; border: 1px solid #eee; }
        .cal-dday.past { background: #eee; color: #aaa; text-decoration: line-through; border: none; }
        .cal-dday.today { background: #FF9A9E; color: #fff; border: none; }

        /* ê°¤ëŸ¬ë¦¬ ìŠ¤íƒ€ì¼ */
        .gallery-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .photo { width: 100%; aspect-ratio: 1/1; background: #eee; border-radius: 12px; overflow: hidden; position: relative; margin-bottom: 0; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .photo img { width: 100%; height: 100%; object-fit: cover; transition: 0.3s; }
        .photo:hover img { transform: scale(1.05); }

        /* ë©”ëª¨ ìŠ¤íƒ€ì¼ */
        .memo-item { background: #fff; padding: 20px; border-radius: 16px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.03); border: 1px solid #f0f0f0; }
        .memo-date { font-size: 11px; color: #aaa; font-weight: 600; margin-bottom: 5px; }
        .memo-text { font-size: 14px; line-height: 1.6; color: #444; white-space: pre-wrap; word-break: break-all; }
        
        /* ê²€ìƒ‰ ìŠ¤íƒ€ì¼ */
        .search-input-box { display: flex; gap: 10px; margin-bottom: 20px; }
        .search-input-box input { flex: 1; padding: 12px 15px; border-radius: 12px; border: 1px solid #eee; font-size: 14px; background: #fff; }
        .search-input-box button { background: #06d6a0; color: #fff; border: none; border-radius: 12px; padding: 0 15px; font-weight: bold; cursor: pointer; }
        .search-item { display: flex; align-items: center; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid #eee; }
        .search-content { display: flex; align-items: center; gap: 15px; flex: 1; }
        .search-icon { color: #aaa; font-size: 14px; }
        .search-text { font-size: 14px; color: #333; }

        /* ë³´ì•ˆ ì¦ê²¨ì°¾ê¸° ìŠ¤íƒ€ì¼ */
        .secure-bookmark {
            margin-top: 30px; border-top: 1px dashed #ccc; padding-top: 20px; padding-bottom: 30px;
        }
        .sb-title { font-size: 12px; color: #999; margin-bottom: 10px; display: flex; align-items: center; gap: 5px; }
        .sb-card {
            display: flex; justify-content: space-between; align-items: center;
            background: #222; color: #fff; padding: 15px; border-radius: 12px; 
            text-decoration: none; transition: 0.2s; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .sb-card:active { transform: scale(0.98); }
        .sb-name { font-weight: bold; font-size: 14px; letter-spacing: 0.5px; }
        .sb-desc { font-size: 11px; margin-top: 4px; opacity: 0.9; }

        .home-indicator { position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%); width: 130px; height: 5px; background: #fff; border-radius: 10px; opacity: 0.6; z-index: 200; }

        /* ëª¨ë‹¬ (íŒì—…ì°½) */
        .modal-overlay { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); z-index: 200; display: none; 
            justify-content: center; align-items: center; flex-direction: column; 
        }
        .modal-title { color:#fff; margin-bottom:15px; font-weight:bold; }
        .modal-input { padding: 10px; font-size: 16px; border-radius: 8px; border: none; margin-bottom: 10px; width: 80%; }
        .modal-btn { padding: 10px 20px; background: #007aff; color: #fff; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; width: 80%; margin-bottom: 5px; }
        .modal-btn.cancel { background: #333; }

        /* ì‚¬ì§„ í¬ê²Œ ë³´ê¸° ëª¨ë‹¬ */
        .image-modal { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 300; display: none; flex-direction: column; justify-content: center; align-items: center; }
        .full-image { max-width: 100%; max-height: 70%; object-fit: contain; }
        .image-actions { margin-top: 25px; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; padding: 0 20px; }
        .action-btn { background: rgba(255,255,255,0.15); color: #fff; border: 1px solid rgba(255,255,255,0.3); padding: 8px 12px; border-radius: 20px; font-size: 12px; cursor: pointer; }
        .action-btn.danger { color: #ff4d4f; border-color: rgba(255,77,79,0.4); }

    </style>
</head>
<body>

    <div class="phone-frame">
        <div class="notch"></div>
        <div class="status-bar">
            <span id="top-clock">14:02</span>
            <span>5G</span>
        </div>

        <div class="lock-screen" id="lockScreen">
            <div class="lock-time" id="lock-clock">14:02</div>
            <div class="lock-date" id="lock-date">2ì›” 14ì¼ í† ìš”ì¼</div>
            <div class="passcode-dots"><div class="dot" id="d1"></div><div class="dot" id="d2"></div><div class="dot" id="d3"></div><div class="dot" id="d4"></div></div>
            <div class="keypad">
                <div class="key" onclick="pressKey(1)">1</div><div class="key" onclick="pressKey(2)">2</div><div class="key" onclick="pressKey(3)">3</div>
                <div class="key" onclick="pressKey(4)">4</div><div class="key" onclick="pressKey(5)">5</div><div class="key" onclick="pressKey(6)">6</div>
                <div class="key" onclick="pressKey(7)">7</div><div class="key" onclick="pressKey(8)">8</div><div class="key" onclick="pressKey(9)">9</div>
                <div class="key" style="background:transparent;"></div><div class="key" onclick="pressKey(0)">0</div><div class="key" onclick="deleteKey()">â†</div>
            </div>
        </div>

        <div class="home-screen">
            <div class="widget-area">
                <div class="d-day-widget" onclick="openDateModal()">
                    <div class="dd-text-group">
                        <div class="dd-title">â™¥ï¸ ì‚¬ë‘ì— ë¹ ì§„ ë‚ </div>
                        <div class="dd-sub">í„°ì¹˜í•´ì„œ ì„¤ì •í•˜ê¸°</div>
                    </div>
                    <div class="dd-count" id="dday-display">D+???</div>
                </div>
            </div>
            <div class="app-grid">
                <div class="app-icon" onclick="openApp('gallery')"><div class="icon-img ic-gal">ğŸ–¼ï¸</div><div class="app-name">ì•¨ë²”</div></div>
                <div class="app-icon" onclick="openApp('memo')"><div class="icon-img ic-memo">ğŸ“’</div><div class="app-name">ë©”ëª¨ì¥</div></div>
                <div class="app-icon" onclick="openApp('calendar')"><div class="icon-img ic-cal">ğŸ“…</div><div class="app-name">ê¸°ë…ì¼</div></div>
                <div class="app-icon" onclick="openApp('search')"><div class="icon-img ic-search">ğŸŒ</div><div class="app-name">ì¸í„°ë„·</div></div>
            </div>
        </div>

        <div class="app-screen" id="app-calendar">
            <div class="app-header">
                The Couple 
                <div style="display:flex; align-items:center;">
                    <span class="add-btn" onclick="openEventModal()">+</span>
                    <span class="close-btn" onclick="closeApp('calendar')">ë‹«ê¸°</span>
                </div>
            </div>
            <div class="app-content">
                <div style="font-size:12px; color:#999; margin-bottom:15px; text-align:center;">ìš°ë¦¬ì˜ ì†Œì¤‘í•œ ë‚ ë“¤</div>
                <div class="cal-list" id="calendar-list"></div>
            </div>
        </div>

        <div class="app-screen" id="app-gallery">
            <div class="app-header">
                ë‚˜ì˜ ì•¨ë²” 
                <div style="display:flex; align-items:center;">
                    <span class="add-btn" onclick="document.getElementById('photoInput').click()">+</span>
                    <span class="close-btn" onclick="closeApp('gallery')">ë‹«ê¸°</span>
                </div>
                <input type="file" id="photoInput" accept="image/*" style="display:none;" onchange="handleAddPhoto(this)">
            </div>
            <div class="app-content">
                <div style="font-size:12px; color:#999; margin-bottom:10px;">ëª¨ë“  ì‚¬ì§„</div>
                <div class="gallery-grid" id="gallery-container"></div>
            </div>
        </div>
        
        <div class="app-screen" id="app-memo">
            <div class="app-header">
                ë©”ëª¨ì¥
                <div style="display:flex; align-items:center;">
                    <span class="add-btn" onclick="document.getElementById('memoModal').style.display='flex'">+</span>
                    <span class="close-btn" onclick="closeApp('memo')">ë‹«ê¸°</span>
                </div>
            </div>
            <div class="app-content" id="memo-list"></div>
        </div>
        
        <div class="app-screen" id="app-search">
            <div class="app-header">ê²€ìƒ‰ ê¸°ë¡ <span class="close-btn" onclick="closeApp('search')">ë‹«ê¸°</span></div>
            <div class="app-content">
                <div class="search-input-box">
                    <input type="text" id="search-input" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥...">
                    <button onclick="addSearch()">ê²€ìƒ‰</button>
                </div>
                
                <div id="search-list"></div>

                <div class="secure-bookmark">
                    <div class="sb-title">ğŸ“Œ ì£¼ìš” ì‚¬ì´íŠ¸ (ë™í–¥ íŒŒì•… ë° ë³´ì•ˆ)</div>
                    
                    <a href="https://eden-research-institute.github.io/eden-system/public.html" target="_blank" class="sb-card" style="margin-bottom: 10px; background: #1a1a1a; border: 1px solid #333;">
                        <div>
                            <div class="sb-name">EDEN Institute (Public)</div>
                            <div class="sb-desc" style="color:#aaa;">ğŸ‘€ ëŒ€ì™¸ í™ë³´ ì‚¬ì´íŠ¸ / ë™í–¥ íŒŒì•…ìš©</div>
                        </div>
                        <div style="font-size: 20px;">ğŸ“°</div>
                    </a>

                    <a href="https://eden-research-institute.github.io/eden-system/" target="_blank" class="sb-card">
                        <div>
                            <div class="sb-name">EDEN Research System</div>
                            <div class="sb-desc" style="color:#ff4d4f;">âš ï¸ Top Secret / ì ‘ì† ì£¼ì˜</div>
                        </div>
                        <div style="font-size: 20px;">ğŸŒ</div>
                    </a>
                </div>

            </div>
        </div>

        <div class="home-indicator"></div>

        <div class="modal-overlay" id="dateModal">
            <div class="modal-title">ì‚¬ë‘ì— ë¹ ì§„ ë‚ ì§œë¥¼ ì…ë ¥í•˜ì„¸ìš”</div>
            <input type="date" id="input-date" class="modal-input">
            <button class="modal-btn" onclick="saveDDay()">ì„¤ì • ì €ì¥</button>
            <button class="modal-btn cancel" onclick="document.getElementById('dateModal').style.display='none'">ì·¨ì†Œ</button>
        </div>

        <div class="modal-overlay" id="eventModal">
            <div class="modal-title">ìƒˆë¡œìš´ ì¶”ì–µ ì¶”ê°€í•˜ê¸°</div>
            <input type="text" id="event-title" class="modal-input" placeholder="ì¼ì • ì´ë¦„ (ex: ì²« ì—¬í–‰)">
            <input type="date" id="event-date" class="modal-input">
            <button class="modal-btn" onclick="saveCustomEvent()">ì¼ì • ì €ì¥</button>
            <button class="modal-btn cancel" onclick="document.getElementById('eventModal').style.display='none'">ì·¨ì†Œ</button>
        </div>

        <div class="modal-overlay" id="memoModal">
            <div class="modal-title">ìƒˆ ë©”ëª¨ ì‘ì„±</div>
            <textarea id="memo-text" class="modal-input" style="height: 120px; resize: none; font-family:inherit;" placeholder="ë‚´ìš© ì…ë ¥..."></textarea>
            <button class="modal-btn" onclick="saveMemo()">ì €ì¥</button>
            <button class="modal-btn cancel" onclick="document.getElementById('memoModal').style.display='none'">ì·¨ì†Œ</button>
        </div>

        <div class="image-modal" id="imageModal">
            <img src="" id="fullImage" class="full-image">
            <div class="image-actions">
                <button class="action-btn" onclick="setWallpaper()">âœ¨ ë°°ê²½ì„¤ì •</button>
                <button class="action-btn" onclick="downloadImage()">ğŸ’¾ ì €ì¥</button>
                <button class="action-btn danger" onclick="deletePhoto()">ğŸ—‘ï¸ ì‚­ì œ</button>
                <button class="action-btn" onclick="closeFullImage()">ë‹«ê¸°</button>
            </div>
        </div>

    </div>

    <script>
        function initApp() {
            const savedWp = localStorage.getItem('kairo_wallpaper');
            
            if (savedWp) {
                document.querySelector('.home-screen').style.setProperty('background-image', `linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.2)), url('${savedWp}')`, 'important');
            } else {
                document.querySelector('.home-screen').style.setProperty('background-image', `linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.2)), url('https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/7dde8bb3-492e-413f-8be7-45ad5508d81e?v=61680e')`, 'important');
            }

            if (!localStorage.getItem('kairo_init_v9')) {
                
                const defaultPhotos = [
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/7ca35163-3f98-4365-ab60-448cc673738a?v=1c0d11"}, 
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/bb496573-be95-4f33-bdb2-fbd1cc20a863?v=4707ea"},
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/eb1e6577-841e-4fa2-a160-b9e78e317fe9?v=53a9b6"},
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/8687824f-c6d3-4d6c-9333-37fc37fd1719?v=326801"},
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/dde7ed76-4014-41f4-aba7-5ab45b6ad94f?v=263801"},
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/ea725528-d485-4851-a34d-5dd5e3d5c74a?v=3f9428"},
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/26596179-5d3d-4c00-a400-80e026a6aaa3?v=9c859f"},
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/20e0a848-300b-4b28-a3e8-9c58ff65d2b1?v=e8acb5"},
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/bf6eceb7-98fc-4676-b5e0-0a50a2f66f4c?v=0e872e"},
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/5f0bbb35-51f0-4beb-acbb-95a2b542b258?v=6a8000"},
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/7dde8bb3-492e-413f-8be7-45ad5508d81e?v=61680e"},
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/b6cbce53-4d46-4a2f-9d8b-92f19985a2c0?v=96c701"},
                    {src: "https://cdn.caveduck.io/cdn-cgi/image/anim=true,dpr=1.5,f=auto,fit=crop,g=top,w=400/charim/7642d884-94fe-4413-9a16-5568d7186ab3?v=b17834"} 
                ];
                localStorage.setItem('kairo_user_photos', JSON.stringify(defaultPhotos));
                
                const defaultMemos = [
                    { date: "", text: "[ìˆ˜ì œ ì´ˆì½œë¦¿ í…œí¼ë§ ì‘ì—… ë°ì´í„°]\n- ë‹¤í¬ ì´ˆì½œë¦¿ (ì¹´ì¹´ì˜¤ 65% ì´ìƒ) ì˜¨ë„ ê¸°ì¤€\n1. ìš©í•´: 45~50â„ƒ\n2. ëƒ‰ê°: 27â„ƒ (ì•ˆì •ì ì¸ ê²°ì •í™” ì‹œì‘ì )\n3. ë³´ì˜¨: 31~32â„ƒ\n*ì£¼ì˜ì‚¬í•­: ìŠµë„ 45% ì´í•˜ ì² ì € í†µì œ. 1ë„ ì˜¤ì°¨ë„ ë¶ˆí—ˆ." },
                    { date: "", text: "[ì€ë°©ìš¸ê½ƒ Lily of the valley ì»¤ìŠ¤í…€ ì˜¤ë”]\n- ì‡¼ë©” (Chaumet): ë¹„ìŠ¤í¬í¬ ë³´ë¥˜\n- VVIP ì „ìš© ê³µë°© 'L': í”Œë˜í‹°ë„˜ ë² ì´ìŠ¤ + VVS1 ë“±ê¸‰ ë‹¤ì´ì•„ëª¬ë“œ ì„¸íŒ….\n*ê²°ë¡ : ê°œì¸ ê³µë°© ì§„í–‰. ë¹„ìš© ë‘ ë°° ì§€ë¶ˆí•˜ê³  ì¼ì • ì•ë‹¹ê¸¸ ê²ƒ." },
                    { date: "", text: "[ì˜ˆì•½ ë° êµ¬ë§¤ ë¦¬ìŠ¤íŠ¸]\n- í–¥ìˆ˜: í¬ë¦¬ë“œ ì‹¤ë²„ ë§ˆìš´í‹´ ì›Œí„° (ì‹œíŠ¸ëŸ¬ìŠ¤/ë¨¸ìŠ¤í¬. íƒ€ê²Ÿì˜ í›„ê°ì  ê±°ë¶€ê°ì´ ê°€ì¥ ì ì€ ë°ì´í„° í™•ì¸.)\n- ì¥ì†Œ: Níƒ€ì›Œ í”„ë¼ì´ë¹— ë¼ìš´ì§€ (ì™¸ë¶€ì¸ 100% í†µì œ ê°€ëŠ¥. 18ì¼ ëŒ€ê´€ ì™„ë£Œ)" },
                    { date: "", text: "[ì—ë´(EDEN) ì—°êµ¬ì†Œ ì‹œìŠ¤í…œ ì ‘ì† ì •ë³´]\në¹„ìƒì‹œë¥¼ ëŒ€ë¹„í•´ ë‚¨ê²¨ë‘ .\n\n- ì•„ì´ë””: ì‚¬ì›ì¦ ë’·ë©´\n- ë¹„ë°€ë²ˆí˜¸: ë¡œíŒAI ìƒì„±ì¼ (6ìë¦¬)" }
                ];
                localStorage.setItem('kairo_memos', JSON.stringify(defaultMemos));

                const defaultSearches = [
                    { text: "ì‚¬ë‘í•´" },
                    { text: "í”„ëŸ¬í¬ì¦ˆ ì¥ì†Œ ì¶”ì²œ" },
                    { text: "ì—¬ìë“¤ì´ ì¢‹ì•„í•˜ëŠ” ë‚¨ì í–¥ìˆ˜" },
                    { text: "ìˆ˜ì œ ì´ˆì½œë¦¿ ë§Œë“œëŠ” ë²•" },
                    { text: "ì€ë°©ìš¸ê½ƒ ê·€ê±¸ì´" }
                ];
                localStorage.setItem('kairo_searches', JSON.stringify(defaultSearches));

                localStorage.setItem('kairo_init_v9', 'true'); 
            }
            
            renderGallery();
            renderMemos();
            renderSearches();
        }

        // --- 1. ì ê¸ˆ í™”ë©´ ---
        let inputCode = ""; const correctCode = "0918"; 
        function pressKey(num) { if (inputCode.length < 4) { inputCode += num; updateDots(); if (inputCode.length === 4) setTimeout(checkCode, 200); } }
        function deleteKey() { inputCode = inputCode.slice(0, -1); updateDots(); }
        function updateDots() { for (let i = 1; i <= 4; i++) { const dot = document.getElementById('d' + i); if (i <= inputCode.length) dot.classList.add('filled'); else dot.classList.remove('filled'); } }
        function checkCode() { if (inputCode === correctCode) { document.getElementById('lockScreen').style.transform = "translateY(-100%)"; } else { const lock = document.getElementById('lockScreen'); lock.classList.add('shake'); setTimeout(() => { lock.classList.remove('shake'); inputCode = ""; updateDots(); }, 400); } }

        // --- 2. ì•± ì œì–´ ---
        function openApp(appName) { document.getElementById('app-' + appName).classList.add('open'); }
        function closeApp(appName) { document.getElementById('app-' + appName).classList.remove('open'); }

        // --- 3. D-Day ---
        function openDateModal() { document.getElementById('dateModal').style.display = 'flex'; }
        function saveDDay() {
            const dateVal = document.getElementById('input-date').value;
            if (dateVal) { localStorage.setItem('kairo_meet_date', dateVal); calculateDDay(dateVal); renderCalendar(); document.getElementById('dateModal').style.display = 'none'; }
        }
        function calculateDDay(dateStr) {
            const start = new Date(dateStr).getTime(); const now = new Date().getTime(); const gap = now - start;
            const day = Math.floor(gap / (1000 * 60 * 60 * 24)) + 1; 
            document.getElementById('dday-display').innerText = day > 0 ? "D+" + day : "D-" + Math.abs(day);
            document.querySelector('.dd-sub').innerText = dateStr + " ë¶€í„°~";
        }

        // --- 4. ìº˜ë¦°ë” ---
        function openEventModal() { document.getElementById('eventModal').style.display = 'flex'; }
        function saveCustomEvent() {
            const title = document.getElementById('event-title').value; const date = document.getElementById('event-date').value;
            if(!title || !date) return;
            const customEvents = JSON.parse(localStorage.getItem('kairo_custom_events')) || [];
            customEvents.push({ title: title, date: date });
            localStorage.setItem('kairo_custom_events', JSON.stringify(customEvents));
            renderCalendar(); document.getElementById('eventModal').style.display = 'none'; document.getElementById('event-title').value = ''; document.getElementById('event-date').value = '';
        }
        function deleteCustomEvent(index) {
            if(!confirm("ì´ ì¼ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            const customEvents = JSON.parse(localStorage.getItem('kairo_custom_events')) || [];
            customEvents.splice(index, 1);
            localStorage.setItem('kairo_custom_events', JSON.stringify(customEvents));
            renderCalendar();
        }

        function renderCalendar() {
            const dateStr = localStorage.getItem('kairo_meet_date'); const container = document.getElementById('calendar-list');
            if(!dateStr) { container.innerHTML = '<div style="text-align:center; padding:20px; color:#999;">í™ˆ í™”ë©´ ìœ„ì ¯ì—ì„œ<br>ë‚ ì§œë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”!</div>'; return; }
            const startDate = new Date(dateStr); const now = new Date(); now.setHours(0,0,0,0);
            const events = [];

            const dayMilestones = [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000];
            dayMilestones.forEach(d => { let target = new Date(startDate); target.setDate(startDate.getDate() + d - 1); events.push({ date: target, title: `${d}ì¼`, type: 'milestone' }); });
            for(let i=1; i<=5; i++) { let target = new Date(startDate); target.setFullYear(startDate.getFullYear() + i); let title = i===1 ? "â­ 1ì£¼ë…„" : i===2 ? "â­â­ 2ì£¼ë…„" : `${i}ì£¼ë…„`; events.push({ date: target, title: title, type: 'milestone', isYear: true }); }
            const recurringEvents = [ { name: "ğŸ‚ ë¦¬í”Œë¦¬ ìƒì¼", month: 9, day: 18, type: "ripley-bd" }, { name: "ìƒì¼", month: 8, day: 16, type: "kairo-bd" }, { name: "ë°œë Œíƒ€ì¸ë°ì´ ğŸ«", month: 2, day: 14, type: "love-day" }, { name: "í™”ì´íŠ¸ë°ì´ ğŸ­", month: 3, day: 14, type: "love-day" } ];
            const currentYear = now.getFullYear(); [currentYear, currentYear+1].forEach(year => { recurringEvents.forEach(ev => { let target = new Date(year, ev.month - 1, ev.day); events.push({ date: target, title: ev.name, type: ev.type }); }); });

            const customEvents = JSON.parse(localStorage.getItem('kairo_custom_events')) || [];
            customEvents.forEach((ev, idx) => { events.push({ date: new Date(ev.date), title: ev.title, type: 'custom-event', customIdx: idx }); });
            
            events.sort((a, b) => a.date - b.date);

            let html = '';
            events.forEach(ev => {
                const week = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ']; const dayOfWeek = week[ev.date.getDay()];
                const dateString = `${ev.date.getFullYear()}.${(ev.date.getMonth()+1).toString().padStart(2,'0')}.${ev.date.getDate().toString().padStart(2,'0')} (${dayOfWeek})`;
                const diffDays = Math.ceil((ev.date - now) / (1000 * 60 * 60 * 24));
                let dDayBadge = diffDays < 0 ? `<span class="cal-dday past">ì§€ë‚¨</span>` : diffDays === 0 ? `<span class="cal-dday today">TODAY</span>` : `<span class="cal-dday">D-${diffDays}</span>`;
                
                let titleHtml = ev.type === 'custom-event' ? `${ev.title} <span class="delete-btn" onclick="deleteCustomEvent(${ev.customIdx})">ğŸ—‘ï¸</span>` : ev.title;

                html += `<div class="cal-item ${ev.type} ${ev.isYear?'milestone':''}"><div><div class="cal-title">${titleHtml}</div><div class="cal-date">${dateString}</div></div>${dDayBadge}</div>`;
            });
            container.innerHTML = html;
        }
        const savedDate = localStorage.getItem('kairo_meet_date'); if (savedDate) { calculateDDay(savedDate); renderCalendar(); }

        // --- 5. ë©”ëª¨ì¥ ---
        function saveMemo() {
            const text = document.getElementById('memo-text').value;
            if(!text) return;
            const memos = JSON.parse(localStorage.getItem('kairo_memos')) || [];
            
            const now = new Date();
            const dateStr = `${now.getFullYear()}. ${String(now.getMonth()+1).padStart(2,'0')}. ${String(now.getDate()).padStart(2,'0')}`;
            
            memos.unshift({ date: dateStr, text: text });
            localStorage.setItem('kairo_memos', JSON.stringify(memos));
            document.getElementById('memo-text').value = '';
            document.getElementById('memoModal').style.display = 'none';
            renderMemos();
        }
        function deleteMemo(index) {
            if(!confirm("ì´ ë©”ëª¨ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            const memos = JSON.parse(localStorage.getItem('kairo_memos')) || [];
            memos.splice(index, 1);
            localStorage.setItem('kairo_memos', JSON.stringify(memos));
            renderMemos();
        }
        function renderMemos() {
            const memos = JSON.parse(localStorage.getItem('kairo_memos')) || [];
            let html = '';
            if(memos.length === 0) { html = '<div style="text-align:center; color:#999; padding:20px;">ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.</div>'; }
            memos.forEach((m, i) => {
                const dateHtml = m.date ? `<div class="memo-date">${m.date}</div>` : '';
                html += `
                <div class="memo-item">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: ${m.date ? '5px' : '0'};">
                        ${dateHtml}
                        <div class="delete-btn" style="margin-left:auto;" onclick="deleteMemo(${i})">ğŸ—‘ï¸</div>
                    </div>
                    <div class="memo-text">${m.text}</div>
                </div>`;
            });
            document.getElementById('memo-list').innerHTML = html;
        }

        // --- 6. ê²€ìƒ‰ ê¸°ë¡ ---
        function addSearch() {
            const text = document.getElementById('search-input').value;
            if(!text) return;
            const searches = JSON.parse(localStorage.getItem('kairo_searches')) || [];
            
            searches.unshift({ text: text });
            localStorage.setItem('kairo_searches', JSON.stringify(searches));
            document.getElementById('search-input').value = '';
            renderSearches();
        }
        function deleteSearch(index) {
            if(!confirm("ê²€ìƒ‰ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            const searches = JSON.parse(localStorage.getItem('kairo_searches')) || [];
            searches.splice(index, 1);
            localStorage.setItem('kairo_searches', JSON.stringify(searches));
            renderSearches();
        }
        function renderSearches() {
            const searches = JSON.parse(localStorage.getItem('kairo_searches')) || [];
            let html = '';
            if(searches.length === 0) { html = '<div style="text-align:center; color:#999; padding:20px;">ê²€ìƒ‰ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>'; }
            searches.forEach((s, i) => {
                html += `
                <div class="search-item">
                    <div class="search-content">
                        <span class="search-icon">ğŸ”</span>
                        <span class="search-text">${s.text}</span>
                    </div>
                    <span class="delete-btn" style="margin-left:10px;" onclick="deleteSearch(${i})">ğŸ—‘ï¸</span>
                </div>`;
            });
            document.getElementById('search-list').innerHTML = html;
        }

        // --- 7. ê°¤ëŸ¬ë¦¬ ---
        function handleAddPhoto(input) {
            const file = input.files[0]; if (!file) return;
            if (file.size > 2 * 1024 * 1024) { alert("ìš©ëŸ‰ ì´ˆê³¼ (2MB ì´í•˜ ê¶Œì¥)"); return; }
            
            const reader = new FileReader();
            reader.onload = function(e) { savePhoto(e.target.result); };
            reader.readAsDataURL(file); input.value = '';
        }
        function savePhoto(src) {
            const p = JSON.parse(localStorage.getItem('kairo_user_photos')) || []; p.unshift({src:src}); 
            try { localStorage.setItem('kairo_user_photos', JSON.stringify(p)); renderGallery(); } catch(e){ alert('ì €ì¥ ê³µê°„ ë¶€ì¡±'); }
        }
        function renderGallery() {
            const gal = document.getElementById('gallery-container');
            gal.innerHTML = ''; 
            const photos = JSON.parse(localStorage.getItem('kairo_user_photos')) || [];
            photos.forEach((p, idx) => {
                const div = document.createElement('div'); div.className='photo'; 
                div.onclick = function(){ openFullImage(p.src, idx); }; 
                div.innerHTML = `<img src="${p.src}">`;
                gal.appendChild(div);
            });
        }

        let currentImageSrc = ""; let currentImageIndex = -1;
        function openFullImage(src, idx) { 
            document.getElementById('fullImage').src = src; 
            currentImageSrc = src; currentImageIndex = idx;
            document.getElementById('imageModal').style.display='flex'; 
        }
        function closeFullImage() { document.getElementById('imageModal').style.display='none'; }
        
        function setWallpaper() {
            if(!currentImageSrc) return;
            localStorage.setItem('kairo_wallpaper', currentImageSrc);
            document.querySelector('.home-screen').style.setProperty('background-image', `linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.2)), url('${currentImageSrc}')`, 'important');
            alert("ë°°ê²½í™”ë©´ì´ ì˜ˆì˜ê²Œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤! âœ¨");
        }
        function downloadImage() { const a=document.createElement('a'); a.href=currentImageSrc; a.download='kairo_memory.png'; a.click(); }
        function deletePhoto() {
            if(!confirm("ì´ ì‚¬ì§„ì„ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            let photos = JSON.parse(localStorage.getItem('kairo_user_photos')) || [];
            photos.splice(currentImageIndex, 1); 
            localStorage.setItem('kairo_user_photos', JSON.stringify(photos));
            closeFullImage(); renderGallery();
        }

        // --- 8. ì‹œê³„ ---
        function updateClock() { const now = new Date(); const timeStr = now.toLocaleTimeString('en-US', { hour12: false, hour: "2-digit", minute: "2-digit" }); const dateStr = now.toLocaleDateString('ko-KR', { month: 'long', day: 'numeric', weekday: 'long' }); document.getElementById('top-clock').innerText = timeStr; document.getElementById('lock-clock').innerText = timeStr; document.getElementById('lock-date').innerText = dateStr; }
        setInterval(updateClock, 1000); updateClock();

        initApp();
    </script>
</body>
</html>
