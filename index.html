<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAIRO'S PHONE</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap');
        
        * { box-sizing: border-box; user-select: none; }
        body { 
            margin: 0; padding: 0; 
            background: #111; 
            display: flex; justify-content: center; align-items: center; 
            min-height: 100vh; font-family: 'Inter', sans-serif; 
        }

        /* í° í”„ë ˆì„ */
        .phone-frame {
            width: 360px; height: 740px;
            background: #000;
            border-radius: 45px;
            border: 10px solid #222;
            box-shadow: 0 0 60px rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
        }

        /* ë…¸ì¹˜ & ìƒë‹¨ë°” */
        .notch {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 120px; height: 25px; background: #000;
            border-bottom-left-radius: 18px; border-bottom-right-radius: 18px;
            z-index: 100;
        }
        .status-bar {
            padding: 12px 25px; display: flex; justify-content: space-between;
            font-size: 13px; color: #fff; font-weight: 600; position: relative; z-index: 90;
        }

        /* --- 1. ì ê¸ˆ í™”ë©´ --- */
        .lock-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://source.unsplash.com/360x740/?pastel,sky');
            background-size: cover;
            display: flex; flex-direction: column; align-items: center; padding-top: 80px;
            color: #fff; backdrop-filter: blur(5px);
            transition: transform 0.4s ease-in-out;
            z-index: 50;
        }
        .lock-time { font-size: 72px; font-weight: 200; letter-spacing: -2px; }
        .lock-date { font-size: 18px; margin-top: -10px; font-weight: 400; margin-bottom: 40px; }

        .passcode-dots { display: flex; gap: 15px; margin-bottom: 40px; }
        .dot { width: 12px; height: 12px; border: 1px solid #fff; border-radius: 50%; transition: 0.2s; }
        .dot.filled { background: #fff; }

        .keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px 30px; width: 80%; }
        .key { width: 70px; height: 70px; border-radius: 50%; background: rgba(255,255,255,0.15); display: flex; justify-content: center; align-items: center; font-size: 24px; font-weight: 400; cursor: pointer; transition: 0.2s; }
        .key:active { background: rgba(255,255,255,0.4); }
        .key:hover { background: rgba(255,255,255,0.2); }

        .shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }

        /* --- 2. í™ˆ í™”ë©´ --- */
        .home-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #1a1a1a;
            display: flex; flex-direction: column; padding-top: 60px;
            z-index: 10;
        }
        
        .widget-area { padding: 20px; }
        .d-day-widget {
            background: linear-gradient(135deg, #FF9A9E, #FECFEF);
            border-radius: 20px; padding: 25px; color: #fff;
            box-shadow: 0 10px 20px rgba(255, 154, 158, 0.3);
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
            cursor: pointer;
        }
        .dd-title { font-size: 13px; font-weight: 600; opacity: 0.9; }
        .dd-count { font-size: 36px; font-weight: 800; margin: 5px 0; }
        .dd-sub { font-size: 12px; text-align: right; opacity: 0.8; font-weight: 500;}

        .app-grid {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px 10px;
            padding: 20px; margin-top: auto; margin-bottom: 30px;
        }
        .app-icon { display: flex; flex-direction: column; align-items: center; gap: 8px; cursor: pointer; transition: 0.2s; }
        .app-icon:active { transform: scale(0.9); }
        .icon-img {
            width: 60px; height: 60px; border-radius: 14px;
            display: flex; justify-content: center; align-items: center;
            font-size: 26px; color: #fff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .app-name { font-size: 11px; color: #fff; font-weight: 500; }

        .ic-gal { background: #4facfe; } 
        .ic-memo { background: #ffd166; } 
        .ic-search { background: #06d6a0; } 
        .ic-call { background: #ef476f; } 
        .ic-rec { background: #118ab2; } 
        .ic-cal { background: #9b5de5; } 

        /* --- 3. ì•± ì‹¤í–‰ í™”ë©´ --- */
        .app-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; z-index: 20;
            transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex; flex-direction: column;
        }
        .app-screen.open { transform: translateY(0); }
        
        .app-header {
            padding: 50px 20px 15px; font-size: 18px; font-weight: 700;
            border-bottom: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center;
            background: rgba(255,255,255,0.98); color: #333;
        }
        .close-btn { font-size: 14px; color: #007aff; cursor: pointer; font-weight: 600; }
        .app-content { flex: 1; overflow-y: auto; padding: 20px; background: #fafafa; }

        .add-photo-btn { font-size: 24px; color: #007aff; cursor: pointer; margin-right: 15px; }

        /* ìº˜ë¦°ë” ìŠ¤íƒ€ì¼ */
        .cal-list { display: flex; flex-direction: column; gap: 10px; padding-bottom: 30px; }
        .cal-item { 
            background: #fff; padding: 15px 20px; border-radius: 12px; 
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03); border: 1px solid #eee;
            position: relative; overflow: hidden;
        }
        
        /* 1ì£¼ë…„, 2ì£¼ë…„ ë“± ê¸°ë…ì¼ ê°•ì¡° */
        .cal-item.milestone { border: 1px solid #FF9A9E; background: #fff5f5; }
        
        /* ë¦¬í”Œë¦¬ ìƒì¼ (ì¤‘ìš”!) */
        .cal-item.ripley-bd { 
            border: 1px solid #9b5de5; background: #f3e5f5; 
        }
        .cal-item.ripley-bd::before {
            content: 'â™¥'; position: absolute; top: -5px; left: -5px; font-size: 40px; color: rgba(155, 93, 229, 0.1);
        }

        /* ì¹´ì´ë¡œ ìƒì¼ (ë¬´ê´€ì‹¬) */
        .cal-item.kairo-bd { background: #f9f9f9; opacity: 0.7; }
        
        /* ë°œë Œíƒ€ì¸/í™”ì´íŠ¸ */
        .cal-item.love-day { background: #fff0f6; border-color: #ffadd2; }

        .cal-title { font-size: 15px; font-weight: 700; color: #333; display: flex; align-items: center; gap: 5px; }
        .cal-date { font-size: 13px; color: #666; margin-top: 2px; }
        .cal-dday { font-size: 12px; font-weight: bold; color: #9b5de5; background: #fff; padding: 4px 8px; border-radius: 6px; border: 1px solid #eee; }
        .cal-dday.past { background: #eee; color: #aaa; text-decoration: line-through; border: none; }
        .cal-dday.today { background: #FF9A9E; color: #fff; border: none; }

        /* ê°¤ëŸ¬ë¦¬/ë©”ëª¨/ê²€ìƒ‰/ë…¹ìŒ ìŠ¤íƒ€ì¼ (ìœ ì§€) */
        .gallery-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .photo { width: 100%; aspect-ratio: 1/1; background: #eee; border-radius: 12px; overflow: hidden; position: relative; margin-bottom: 0; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .photo img { width: 100%; height: 100%; object-fit: cover; transition: 0.3s; }
        .photo:hover img { transform: scale(1.05); }
        .photo-caption { position: absolute; bottom: 0; left: 0; width: 100%; background: linear-gradient(transparent, rgba(0,0,0,0.7)); color: #fff; font-size: 11px; padding: 10px 10px 5px; }

        .memo-item { background: #fff; padding: 20px; border-radius: 16px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.03); border: 1px solid #f0f0f0; }
        .memo-date { font-size: 11px; color: #aaa; margin-bottom: 8px; font-weight: 600; }
        .memo-text { font-size: 14px; line-height: 1.6; color: #444; }

        .search-item { display: flex; align-items: center; gap: 15px; padding: 15px 0; border-bottom: 1px solid #eee; }
        .search-icon { color: #aaa; font-size: 14px; }
        .search-text { font-size: 14px; color: #333; flex: 1; }
        .search-date { font-size: 11px; color: #bbb; }

        .rec-item { background: #fff; padding: 15px; border-radius: 12px; margin-bottom: 10px; display: flex; align-items: center; gap: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .play-icon { width: 36px; height: 36px; background: #f0f0f0; border-radius: 50%; display: flex; justify-content: center; align-items: center; color: #ef476f; font-size: 14px; }

        .home-indicator { position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%); width: 130px; height: 5px; background: #fff; border-radius: 10px; opacity: 0.6; z-index: 200; }

        /* ëª¨ë‹¬ë“¤ */
        .date-modal { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 200; display: none; justify-content: center; align-items: center; flex-direction: column; }
        .date-input { padding: 10px; font-size: 16px; border-radius: 8px; border: none; margin-bottom: 10px; }
        .save-btn { padding: 10px 20px; background: #007aff; color: #fff; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }

        .image-modal { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 300; display: none; flex-direction: column; justify-content: center; align-items: center; }
        .full-image { max-width: 100%; max-height: 70%; object-fit: contain; }
        .image-caption { color: #fff; margin-top: 20px; font-size: 14px; padding: 0 20px; text-align: center; }
        .image-actions { margin-top: 30px; display: flex; gap: 20px; }
        .action-btn { background: rgba(255,255,255,0.2); color: #fff; border: 1px solid rgba(255,255,255,0.3); padding: 8px 16px; border-radius: 20px; font-size: 13px; cursor: pointer; }

    </style>
</head>
<body>

    <div class="phone-frame">
        <div class="notch"></div>
        <div class="status-bar">
            <span id="top-clock">14:02</span>
            <span>5G</span>
        </div>

        <div class="lock-screen" id="lockScreen">
            <div class="lock-time" id="lock-clock">14:02</div>
            <div class="lock-date" id="lock-date">2ì›” 14ì¼ í† ìš”ì¼</div>
            <div class="passcode-dots"><div class="dot" id="d1"></div><div class="dot" id="d2"></div><div class="dot" id="d3"></div><div class="dot" id="d4"></div></div>
            <div class="keypad">
                <div class="key" onclick="pressKey(1)">1</div><div class="key" onclick="pressKey(2)">2</div><div class="key" onclick="pressKey(3)">3</div>
                <div class="key" onclick="pressKey(4)">4</div><div class="key" onclick="pressKey(5)">5</div><div class="key" onclick="pressKey(6)">6</div>
                <div class="key" onclick="pressKey(7)">7</div><div class="key" onclick="pressKey(8)">8</div><div class="key" onclick="pressKey(9)">9</div>
                <div class="key" style="background:transparent;"></div><div class="key" onclick="pressKey(0)">0</div><div class="key" onclick="deleteKey()">â†</div>
            </div>
        </div>

        <div class="home-screen">
            <div class="widget-area">
                <div class="d-day-widget" onclick="openDateModal()">
                    <div class="dd-title">â™¥ï¸</div>
                    <div class="dd-count" id="dday-display">D + ???</div>
                    <div class="dd-sub">í„°ì¹˜í•´ì„œ ë‚ ì§œ ì„¤ì •í•˜ê¸°</div>
                </div>
            </div>
            <div class="app-grid">
                <div class="app-icon" onclick="openApp('gallery')"><div class="icon-img ic-gal">ğŸ–¼ï¸</div><div class="app-name">ì•¨ë²”</div></div>
                <div class="app-icon" onclick="openApp('memo')"><div class="icon-img ic-memo">ğŸ“’</div><div class="app-name">ì¼ê¸°ì¥</div></div>
                <div class="app-icon" onclick="openApp('calendar')"><div class="icon-img ic-cal">ğŸ“…</div><div class="app-name">ê¸°ë…ì¼</div></div>
                <div class="app-icon" onclick="openApp('search')"><div class="icon-img ic-search">ğŸŒ</div><div class="app-name">ì¸í„°ë„·</div></div>
                <div class="app-icon" onclick="openApp('record')"><div class="icon-img ic-rec">ğŸ™ï¸</div><div class="app-name">ë…¹ìŒ</div></div>
            </div>
        </div>

        <div class="app-screen" id="app-calendar">
            <div class="app-header">The Couple <span class="close-btn" onclick="closeApp('calendar')">ë‹«ê¸°</span></div>
            <div class="app-content">
                <div style="font-size:12px; color:#999; margin-bottom:15px; text-align:center;">
                    ìš°ë¦¬ì˜ ëª¨ë“  ìˆœê°„ë“¤
                </div>
                <div class="cal-list" id="calendar-list">
                    </div>
            </div>
        </div>

        <div class="app-screen" id="app-gallery">
            <div class="app-header">
                ë‚˜ì˜ ì•¨ë²” 
                <div style="display:flex; align-items:center;">
                    <span class="add-photo-btn" onclick="document.getElementById('photoInput').click()">+</span>
                    <span class="close-btn" onclick="closeApp('gallery')">ë‹«ê¸°</span>
                </div>
                <input type="file" id="photoInput" accept="image/*" style="display:none;" onchange="handleAddPhoto(this)">
            </div>
            <div class="app-content">
                <div style="font-size:12px; color:#999; margin-bottom:10px;">ì¦ê²¨ì°¾ëŠ” í•­ëª©</div>
                <div class="gallery-grid" id="gallery-container">
                    <div class="photo" onclick="openFullImage(this.querySelector('img').src, 'ê·¸ë…€ê°€ ì²˜ìŒ ì¤€ ì¢…ì´ê½ƒ')"><img src="https://source.unsplash.com/200x200/?hand,holding,flower" alt=""><div class="photo-caption">ê·¸ë…€ê°€ ì²˜ìŒ ì¤€ ì¢…ì´ê½ƒ</div></div>
                    <div class="photo" onclick="openFullImage(this.querySelector('img').src, 'ì°½ê°€ì— ì•‰ì€ ë’·ëª¨ìŠµ')"><img src="https://source.unsplash.com/200x200/?sunlight,window" alt=""><div class="photo-caption">ì°½ê°€ì— ì•‰ì€ ë’·ëª¨ìŠµ</div></div>
                    <div class="photo" onclick="openFullImage(this.querySelector('img').src, 'ë‚˜ë¥¼ ê·¸ë ¤ì¤€ ê·¸ë¦¼ (ê·€ì—½ë‹¤)')"><img src="https://source.unsplash.com/200x200/?sketch,drawing,pencil" alt=""><div class="photo-caption">ë‚˜ë¥¼ ê·¸ë ¤ì¤€ ê·¸ë¦¼ (ê·€ì—½ë‹¤)</div></div>
                    <div class="photo" onclick="openFullImage(this.querySelector('img').src, 'ì„¸ìƒì—ì„œ ì œì¼ í‰ì˜¨í•œ ì–¼êµ´')"><img src="https://source.unsplash.com/200x200/?sleeping,peaceful" alt=""><div class="photo-caption">ì„¸ìƒì—ì„œ ì œì¼ í‰ì˜¨í•œ ì–¼êµ´</div></div>
                </div>
            </div>
        </div>
        <div class="app-screen" id="app-memo">
            <div class="app-header">ë¹„ë°€ ì¼ê¸° <span class="close-btn" onclick="closeApp('memo')">ë‹«ê¸°</span></div>
            <div class="app-content">
                <div class="memo-item"><div class="memo-date">ì˜¤ëŠ˜ ìƒˆë²½ 02:00</div><div class="memo-text">ì•…ëª½ì„ ê¾¸ëŠ” ê²ƒ ê°™ì•„ì„œ ì†ì„ ì¡ì•„ì£¼ì—ˆë‹¤. ë–¨ë¦¼ì´ ë©ˆì·„ë‹¤. <br>ë‚´ ì†ì´ ì°¨ê°€ì›Œì„œ ê¹°ê¹Œ ë´ ê±±ì •í–ˆëŠ”ë°, ì˜¤íˆë ¤ ë” ê½‰ ì¥ê³  ì ë“¤ì—ˆë‹¤.<br>ì´ ì†ì„ ì˜ì›íˆ ë†“ì§€ ì•Šì„ ê²ƒì´ë‹¤.</div></div>
                <div class="memo-item"><div class="memo-date">ì–´ì œ</div><div class="memo-text">ì˜¤ëŠ˜ ë°°ì‹ì— ë‚˜ì˜¨ í‘¸ë”©ì„ ë³´ê³  ëˆˆì´ ë™ê·¸ë—ê²Œ ì»¤ì¡Œë‹¤. <br>ë‹¨ ê²ƒì„ ì¢‹ì•„í•˜ëŠ”êµ¬ë‚˜. ê¸°ì–µí•´ ë‘¬ì•¼ì§€.<br>ë‹¤ìŒì—” ëª°ë˜ ì´ˆì½œë¦¿ì„ ê°€ì ¸ë‹¤ ì¤„ê¹Œ? ê±¸ë¦¬ë©´ ì§•ê³„ì§€ë§Œ ìƒê´€ì—†ë‹¤.</div></div>
                <div class="memo-item"><div class="memo-date">2026. 02. 05</div><div class="memo-text">ë‚´ê°€ ì§€ì€ ì£„ë¥¼ ì”»ì„ ìˆ˜ ìˆëŠ” ìœ ì¼í•œ ë°©ë²•ì€ ë„ˆë¥¼ ì—¬ê¸°ì„œ ë°ë¦¬ê³  ë‚˜ê°€ëŠ” ê²ƒë¿ì´ë‹¤.<br>ì¡°ê¸ˆë§Œ ê¸°ë‹¤ë ¤ì¤˜. ì™„ë²½í•œ ê³„íšì„ ì„¸ìš°ê³  ìˆì–´.</div></div>
            </div>
        </div>
        <div class="app-screen" id="app-search">
            <div class="app-header">ê²€ìƒ‰ ê¸°ë¡ <span class="close-btn" onclick="closeApp('search')">ë‹«ê¸°</span></div>
            <div class="app-content">
                <div class="search-item"><span class="search-icon">ğŸ”</span><span class="search-text">ì•…ëª½ì„ ê¾¸ì§€ ì•Šê²Œ í•˜ëŠ” ì°¨(Tea)</span><span class="search-date">ë°©ê¸ˆ ì „</span></div>
                <div class="search-item"><span class="search-icon">ğŸ”</span><span class="search-text">ì—¬ì ë¨¸ë¦¬ ì•ˆ ì•„í”„ê²Œ ë¬¶ëŠ” ë²•</span><span class="search-date">1ì‹œê°„ ì „</span></div>
                <div class="search-item"><span class="search-icon">ğŸ”</span><span class="search-text">í–‡ë¹›ì„ ëª» ë³´ë©´ ìƒê¸°ëŠ” ë³‘</span><span class="search-date">ì–´ì œ</span></div>
                <div class="search-item"><span class="search-icon">ğŸ”</span><span class="search-text">ìˆ˜ì œ ì´ˆì½œë¦¿ ë§Œë“œëŠ” ë²• (ì´ˆë³´)</span><span class="search-date">2ì¼ ì „</span></div>
                <div class="search-item"><span class="search-icon">ğŸ”</span><span class="search-text">ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒì„ ì§€í‚¤ëŠ” ë²•</span><span class="search-date">3ì¼ ì „</span></div>
            </div>
        </div>
        <div class="app-screen" id="app-record">
            <div class="app-header">ìŒì„± ë©”ëª¨ <span class="close-btn" onclick="closeApp('record')">ë‹«ê¸°</span></div>
            <div class="app-content">
                <div class="rec-item"><div class="play-icon">â–¶</div><div><div style="font-weight:bold;">ì²˜ìŒìœ¼ë¡œ ì›ƒì€ ë‚ .mp3</div><div style="font-size:12px; color:#888;">2026.02.14 | 00:15</div></div></div>
                <div class="rec-item"><div class="play-icon">â–¶</div><div><div style="font-weight:bold;">ìì¥ê°€ ì—°ìŠµ (ë§í•¨).mp3</div><div style="font-size:12px; color:#888;">2026.02.10 | 03:40</div></div></div>
                <div class="rec-item"><div class="play-icon">â–¶</div><div><div style="font-weight:bold;">ìƒˆ ì†Œë¦¬ (ë“¤ë ¤ì£¼ë ¤ê³ ).mp3</div><div style="font-size:12px; color:#888;">2026.02.01 | 05:20</div></div></div>
            </div>
        </div>

        <div class="home-indicator"></div>

        <div class="date-modal" id="dateModal">
            <div style="color:#fff; margin-bottom:15px; font-weight:bold;">ì²˜ìŒ ë§Œë‚œ ë‚ ì§œë¥¼ ì…ë ¥í•˜ì„¸ìš”</div>
            <input type="date" id="input-date" class="date-input">
            <button class="save-btn" onclick="saveDDay()">ì„¤ì • ì €ì¥</button>
            <button class="save-btn" style="background:#333; margin-top:10px;" onclick="document.getElementById('dateModal').style.display='none'">ì·¨ì†Œ</button>
        </div>

        <div class="image-modal" id="imageModal">
            <img src="" id="fullImage" class="full-image">
            <div class="image-caption" id="fullCaption"></div>
            <div class="image-actions">
                <button class="action-btn" onclick="downloadImage()">ğŸ’¾ ì €ì¥í•˜ê¸°</button>
                <button class="action-btn" onclick="closeFullImage()">ë‹«ê¸°</button>
            </div>
        </div>

    </div>

    <script>
        // --- 1. ì ê¸ˆ í™”ë©´ ---
        let inputCode = ""; const correctCode = "0918"; 
        function pressKey(num) { if (inputCode.length < 4) { inputCode += num; updateDots(); if (inputCode.length === 4) setTimeout(checkCode, 200); } }
        function deleteKey() { inputCode = inputCode.slice(0, -1); updateDots(); }
        function updateDots() { for (let i = 1; i <= 4; i++) { const dot = document.getElementById('d' + i); if (i <= inputCode.length) dot.classList.add('filled'); else dot.classList.remove('filled'); } }
        function checkCode() { if (inputCode === correctCode) { document.getElementById('lockScreen').style.transform = "translateY(-100%)"; } else { const lock = document.getElementById('lockScreen'); lock.classList.add('shake'); setTimeout(() => { lock.classList.remove('shake'); inputCode = ""; updateDots(); }, 400); } }

        // --- 2. ì•± ì œì–´ ---
        function openApp(appName) { document.getElementById('app-' + appName).classList.add('open'); }
        function closeApp(appName) { document.getElementById('app-' + appName).classList.remove('open'); }

        // --- 3. D-Day ë° ìº˜ë¦°ë” ì—°ë™ ---
        function openDateModal() { document.getElementById('dateModal').style.display = 'flex'; }
        
        function saveDDay() {
            const dateVal = document.getElementById('input-date').value;
            if (dateVal) {
                localStorage.setItem('kairo_meet_date', dateVal);
                calculateDDay(dateVal);
                renderCalendar(); 
                document.getElementById('dateModal').style.display = 'none';
            }
        }

        function calculateDDay(dateStr) {
            const start = new Date(dateStr).getTime();
            const now = new Date().getTime();
            const gap = now - start;
            const day = Math.floor(gap / (1000 * 60 * 60 * 24)) + 1; 
            document.getElementById('dday-display').innerText = day > 0 ? "D + " + day : "D - " + Math.abs(day);
            document.querySelector('.dd-sub').innerText = dateStr + " ë¶€í„° ì‚¬ë‘í•˜ëŠ” ì¤‘";
        }
        
        // --- â˜… ìº˜ë¦°ë” ìë™ ê³„ì‚° ë¡œì§ (ê¸°ë…ì¼ í†µí•©) â˜… ---
        function renderCalendar() {
            const dateStr = localStorage.getItem('kairo_meet_date');
            const container = document.getElementById('calendar-list');
            if(!dateStr) {
                container.innerHTML = '<div style="text-align:center; padding:20px; color:#999; font-size:13px;">í™ˆ í™”ë©´ ìœ„ì ¯ì—ì„œ<br>ë‚ ì§œë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”!</div>';
                return;
            }

            const startDate = new Date(dateStr);
            const now = new Date();
            now.setHours(0,0,0,0);
            const events = [];

            // 1. ê³ ì • ê¸°ë…ì¼ (100ì¼, 200ì¼...)
            const dayMilestones = [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000];
            dayMilestones.forEach(d => {
                let target = new Date(startDate);
                target.setDate(startDate.getDate() + d - 1);
                events.push({ date: target, title: `${d}ì¼`, type: 'milestone' });
            });

            // 2. ì—° ë‹¨ìœ„ ê¸°ë…ì¼ (1ì£¼ë…„ ~ 5ì£¼ë…„)
            for(let i=1; i<=5; i++) {
                let target = new Date(startDate);
                target.setFullYear(startDate.getFullYear() + i); // ì •í™•íˆ ì—°ë„ë§Œ ë”í•¨
                // (ìœ¤ë…„ ë“± ë¯¸ì„¸í•œ ì°¨ì´ëŠ” ì»¤í”Œì•±ë“¤ë§ˆë‹¤ ë°©ì‹ì´ ë‹¤ë¥¸ë°, ë³´í†µ ì—°ë„ë¥¼ ë°”ê¿ˆ)
                let title = `${i}ì£¼ë…„`;
                if(i===1) title = "â­ 1ì£¼ë…„";
                if(i===2) title = "â­â­ 2ì£¼ë…„";
                if(i===3) title = "â­â­â­ 3ì£¼ë…„";
                events.push({ date: target, title: title, type: 'milestone', isYear: true });
            }

            // 3. ë§¤ë…„ ë°˜ë³µë˜ëŠ” ì´ë²¤íŠ¸ (ì˜¬í•´, ë‚´ë…„ ê¸°ì¤€ ì¶”ê°€)
            // ë¦¬í”Œë¦¬ ìƒì¼(9/18), ì¹´ì´ë¡œ ìƒì¼(8/16), ë°œë Œíƒ€ì¸(2/14), í™”ì´íŠ¸(3/14)
            const recurringEvents = [
                { name: "ğŸ‚ ë¦¬í”Œë¦¬ ìƒì¼", month: 9, day: 18, type: "ripley-bd" },
                { name: "ìƒì¼ (ì¹´ì´ë¡œ)", month: 8, day: 16, type: "kairo-bd" },
                { name: "ë°œë Œíƒ€ì¸ë°ì´ ğŸ«", month: 2, day: 14, type: "love-day" },
                { name: "í™”ì´íŠ¸ë°ì´ ğŸ­", month: 3, day: 14, type: "love-day" }
            ];

            const currentYear = now.getFullYear();
            // ì˜¬í•´ì™€ ë‚´ë…„ì˜ ì´ë²¤íŠ¸ë¥¼ ëª¨ë‘ ìƒì„±í•´ì„œ ë¦¬ìŠ¤íŠ¸ì— ë„£ìŒ
            [currentYear, currentYear+1].forEach(year => {
                recurringEvents.forEach(ev => {
                    let target = new Date(year, ev.month - 1, ev.day);
                    events.push({ date: target, title: ev.name, type: ev.type });
                });
            });

            // 4. ë‚ ì§œìˆœ ì •ë ¬
            events.sort((a, b) => a.date - b.date);

            // 5. HTML ìƒì„±
            let html = '';
            events.forEach(ev => {
                // ì´ë¯¸ ì§€ë‚œ ì´ë²¤íŠ¸ ì¤‘, ë„ˆë¬´ ì˜¤ë˜ëœ(3ê°œì›” ì „) ê±´ ì•ˆ ë³´ì—¬ì¤„ ìˆ˜ë„ ìˆì§€ë§Œ ì¼ë‹¨ ë‹¤ ë³´ì—¬ì¤Œ
                // ë‹¨, ë°˜ë³µ ì´ë²¤íŠ¸ëŠ” "ì˜¤ëŠ˜ ì´í›„" ë˜ëŠ” "ìµœê·¼ ê²ƒ"ë§Œ ë³´ì—¬ì£¼ëŠ” ê²Œ ê¹”ë”í•  ìˆ˜ ìˆìŒ.
                // ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœí•˜ê²Œ ë¦¬ìŠ¤íŠ¸ì—…
                
                const week = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
                const dayOfWeek = week[ev.date.getDay()];
                const dateString = `${ev.date.getFullYear()}.${(ev.date.getMonth()+1).toString().padStart(2,'0')}.${ev.date.getDate().toString().padStart(2,'0')} (${dayOfWeek})`;
                
                // D-Day ê³„ì‚°
                const diffTime = ev.date - now;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                let dDayBadge = "";
                if(diffDays < 0) dDayBadge = `<span class="cal-dday past">ì§€ë‚¨</span>`;
                else if(diffDays === 0) dDayBadge = `<span class="cal-dday today">TODAY</span>`;
                else dDayBadge = `<span class="cal-dday">D-${diffDays}</span>`;

                // ìŠ¤íƒ€ì¼ í´ë˜ìŠ¤
                let itemClass = "";
                if(ev.isYear) itemClass = "milestone"; // ì£¼ë…„
                if(ev.type === "ripley-bd") itemClass = "ripley-bd";
                if(ev.type === "kairo-bd") itemClass = "kairo-bd";
                if(ev.type === "love-day") itemClass = "love-day";

                html += `
                    <div class="cal-item ${itemClass}">
                        <div>
                            <div class="cal-title">${ev.title}</div>
                            <div class="cal-date">${dateString}</div>
                        </div>
                        ${dDayBadge}
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        const savedDate = localStorage.getItem('kairo_meet_date'); 
        if (savedDate) { calculateDDay(savedDate); renderCalendar(); }

        // --- 4. ì‹œê³„ ---
        function updateClock() { const now = new Date(); const timeStr = now.toLocaleTimeString('en-US', { hour12: false, hour: "2-digit", minute: "2-digit" }); const dateStr = now.toLocaleDateString('ko-KR', { month: 'long', day: 'numeric', weekday: 'long' }); document.getElementById('top-clock').innerText = timeStr; document.getElementById('lock-clock').innerText = timeStr; document.getElementById('lock-date').innerText = dateStr; }
        setInterval(updateClock, 1000); updateClock();

        // --- 5. ì•¨ë²” ê¸°ëŠ¥ ---
        function handleAddPhoto(input) {
            const file = input.files[0];
            if (!file) return;
            if (file.size > 2 * 1024 * 1024) { alert("íŒŒì¼ ìš©ëŸ‰ì´ ë„ˆë¬´ í½ë‹ˆë‹¤. (2MB ì´í•˜ ê¶Œì¥)"); return; }
            const comment = prompt("ì´ ì‚¬ì§„ì— ëŒ€í•œ ê¸°ì–µì„ ì…ë ¥í•˜ì„¸ìš” (ex: í–‰ë³µí–ˆë˜ ë‚ )");
            if (comment === null) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                const base64Img = e.target.result;
                savePhoto(base64Img, comment || "ê¸°ì–µ ì—†ìŒ");
            };
            reader.readAsDataURL(file);
            input.value = ''; 
        }

        function savePhoto(imgSrc, caption) {
            const photos = JSON.parse(localStorage.getItem('kairo_user_photos')) || [];
            photos.push({ src: imgSrc, caption: caption }); 
            try {
                localStorage.setItem('kairo_user_photos', JSON.stringify(photos));
                renderPhoto(imgSrc, caption); 
            } catch (e) { alert("ì €ì¥ ê³µê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. ì‚¬ì§„ì„ ì¶”ê°€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); }
        }

        function renderPhoto(src, caption) {
            const container = document.getElementById('gallery-container');
            const div = document.createElement('div');
            div.className = 'photo';
            div.onclick = function() { openFullImage(src, caption); };
            div.innerHTML = `<img src="${src}" alt="User Photo"><div class="photo-caption">${caption}</div>`;
            container.prepend(div);
        }

        function loadSavedPhotos() {
            const photos = JSON.parse(localStorage.getItem('kairo_user_photos')) || [];
            photos.forEach(p => renderPhoto(p.src, p.caption));
        }
        loadSavedPhotos();

        // --- 6. ì´ë¯¸ì§€ ëª¨ë‹¬ ---
        let currentImageSrc = "";
        function openFullImage(src, caption) {
            const modal = document.getElementById('imageModal');
            document.getElementById('fullImage').src = src;
            document.getElementById('fullCaption').innerText = caption;
            currentImageSrc = src; 
            modal.style.display = 'flex';
        }
        function closeFullImage() { document.getElementById('imageModal').style.display = 'none'; }
        function downloadImage() {
            if(!currentImageSrc) return;
            const link = document.createElement('a');
            link.href = currentImageSrc;
            link.download = 'Kairo_Memory_' + new Date().getTime() + '.png';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
